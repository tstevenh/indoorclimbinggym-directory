---
/**
 * BlogCategories Component
 * Category filter tabs for blog posts
 * Auto-discovers categories from existing blog posts
 */

import { getCollection } from 'astro:content';

interface Props {
  currentCategory?: string;
}

const { currentCategory = 'all' } = Astro.props;

// Auto-discover all unique categories from blog posts
const allPosts = await getCollection('blog');
const uniqueCategories = [...new Set(allPosts.map(post => post.data.category))].sort();

// Helper function to capitalize category names
const capitalize = (str: string) => str.charAt(0).toUpperCase() + str.slice(1);

// Build categories array with "All Articles" first
const categories = [
  { slug: 'all', label: 'All Articles', href: '/guides' },
  ...uniqueCategories.map(cat => ({
    slug: cat,
    label: capitalize(cat),
    href: `/guides/${cat}`
  }))
];
---

<nav class="mb-8 overflow-x-auto">
  <div class="flex gap-2 min-w-max pb-2">
    {categories.map((cat) => (
      <a
        href={cat.href}
        class={`px-4 py-2 rounded-full text-sm font-semibold transition-all whitespace-nowrap ${
          currentCategory === cat.slug
            ? 'bg-sage text-white'
            : 'bg-white text-granite hover:bg-gray-100 border border-gray-200'
        }`}
      >
        {cat.label}
      </a>
    ))}
  </div>
</nav>
