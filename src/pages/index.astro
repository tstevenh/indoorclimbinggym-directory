---
/**
 * Homepage
 * Main landing page with hero, featured gyms, and popular cities
 */
import BaseLayout from '../layouts/BaseLayout.astro';
import GymCard from '../components/GymCard.astro';
import SearchBar from '../components/SearchBar.astro';
import { generateOrganizationSchema, generateWebSiteSchema } from '../utils/schema';
import { fetchGyms } from '../config/api';

export const prerender = true;

// Fetch gyms from API at build time
const gyms = await fetchGyms();

// Get top rated gyms for featured section
const featuredGyms = gyms.sort((a, b) => {
  // Featured gyms first
  if (a.featured !== b.featured) return b.featured ? 1 : -1;
  // Then by rating (highest first)
  if (a.rating !== b.rating) return b.rating - a.rating;
  // Then alphabetically
  return a.name.localeCompare(b.name);
}).slice(0, 6);

// Get unique cities
const cities = [...new Set(gyms.map(g => ({ city: g.city, region: g.region, slug: g.slug })))];
const popularCities = cities.slice(0, 6);

// Generate homepage schemas
const orgSchema = generateOrganizationSchema();
const websiteSchema = generateWebSiteSchema();
const combinedSchema = [orgSchema, websiteSchema];

// SEO data
const title = 'Find the Best Indoor Climbing Gyms Near You | Indoor Climbing Gym Directory';
const description = 'Discover the best indoor climbing gyms near you. Search by location, amenities, and climbing type. Browse 15+ gyms across 5 major cities with detailed reviews, prices, and directions.';
---

<BaseLayout
  title={title}
  description={description}
  schema={combinedSchema}
>
  <!-- Hero Section -->
  <section class="bg-gradient-to-br from-sage/20 to-ivory py-16 md:py-24 -mx-4 px-4 mb-12">
    <div class="max-w-4xl mx-auto text-center">
      <h1 class="text-4xl md:text-6xl font-bold text-granite mb-6">
        Find the Best Indoor Climbing Gyms Near You
      </h1>
      <p class="text-xl md:text-2xl text-gray-700 mb-8">
        Your complete guide to indoor climbing gyms across America. Search by location, amenities, and climbing type.
      </p>

      <!-- Hero Search Bar -->
      <div class="max-w-2xl mx-auto">
        <SearchBar large={true} placeholder="Search by city, state, or gym name..." />
      </div>

      <!-- Quick Stats -->
      <div class="grid grid-cols-3 gap-4 mt-12 max-w-2xl mx-auto">
        <div class="text-center">
          <div class="text-3xl font-bold text-sage">{gyms.length}</div>
          <div class="text-sm text-gray-600">Gyms</div>
        </div>
        <div class="text-center">
          <div class="text-3xl font-bold text-sage">{cities.length}</div>
          <div class="text-sm text-gray-600">Cities</div>
        </div>
        <div class="text-center">
          <div class="text-3xl font-bold text-sage">
            {[...new Set(gyms.map(g => g.region))].length}
          </div>
          <div class="text-sm text-gray-600">States</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Gyms Section -->
  <section class="mb-16">
    <div class="flex items-center justify-between mb-8">
      <div>
        <h2 class="text-3xl font-bold text-granite mb-2">Top Rated Climbing Gyms</h2>
        <p class="text-gray-600">Highly rated gyms from climbers like you</p>
      </div>
      <a href="/search" class="text-sage font-medium hover:underline">
        View All →
      </a>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {featuredGyms.map(gym => (
        <GymCard gym={gym} />
      ))}
    </div>
  </section>

  <!-- Why Use IndoorClimbingGym.com Section -->
  <section class="bg-white rounded-lg shadow-md p-8 md:p-12 mb-16">
    <div class="text-center mb-12">
      <h2 class="text-3xl font-bold text-granite mb-4">Why Use IndoorClimbingGym.com?</h2>
      <p class="text-gray-600 text-lg">Your trusted partner for finding the perfect indoor climbing gym</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
      <div class="text-center">
        <div class="w-16 h-16 bg-sage/20 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-sage" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
        </div>
        <h3 class="font-bold text-granite mb-2 text-lg">Comprehensive Directory</h3>
        <p class="text-gray-600 text-sm">
          15+ climbing gyms across 5 major cities, from bouldering havens to full-service facilities
        </p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-sage/20 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-sage" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <h3 class="font-bold text-granite mb-2 text-lg">Detailed Information</h3>
        <p class="text-gray-600 text-sm">
          Hours, prices, amenities, and directions for every gym—everything you need to plan your visit
        </p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-sage/20 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-sage" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
          </svg>
        </div>
        <h3 class="font-bold text-granite mb-2 text-lg">Smart Filters</h3>
        <p class="text-gray-600 text-sm">
          Find gyms by climbing type, amenities, budget, and location—exactly what you're looking for
        </p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-sage/20 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-sage" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
          </svg>
        </div>
        <h3 class="font-bold text-granite mb-2 text-lg">Expert Guides</h3>
        <p class="text-gray-600 text-sm">
          Learn about climbing techniques, gear, gym etiquette, and training tips from experienced climbers
        </p>
      </div>
    </div>
  </section>

  <!-- Explore Climbing Gyms by Region Section -->
  <section class="mb-16 bg-gradient-to-br from-sage/10 to-ivory rounded-lg p-8 md:p-12">
    <div class="max-w-4xl mx-auto">
      <h2 class="text-3xl font-bold text-granite mb-4 text-center">Explore Indoor Climbing Gyms by Region</h2>
      <p class="text-gray-700 leading-relaxed text-center">
        From the Pacific Northwest's legendary bouldering scene in Seattle to the booming climbing community in Denver,
        indoor climbing gyms are transforming how people experience vertical sports. Whether you're in Texas's sunny Austin,
        California's vibrant Los Angeles, or New York City's bustling boroughs, there's a climbing gym waiting for you.
        Each region brings its unique climbing culture, from competitive bouldering walls to family-friendly facilities with
        beginner classes and youth programs.
      </p>
    </div>
  </section>

  <!-- Popular Cities Section -->
  <section class="mb-16">
    <div class="mb-8">
      <h2 class="text-3xl font-bold text-granite mb-2">Browse by City</h2>
      <p class="text-gray-600">Explore climbing gyms in popular climbing destinations across America</p>
    </div>

    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
      {popularCities.map(city => {
        const gymCount = gyms.filter(g => g.city === city.city).length;
        return (
          <a
            href={`/search?city=${encodeURIComponent(city.city)}`}
            class="bg-white rounded-lg shadow-md p-6 text-center hover:shadow-xl transition-shadow duration-300 group"
          >
            <h3 class="font-bold text-granite group-hover:text-sage transition-colors">
              {city.city}
            </h3>
            <p class="text-sm text-gray-600 mt-1">{city.region}</p>
            <p class="text-xs text-sage font-medium mt-2">{gymCount} {gymCount === 1 ? 'gym' : 'gyms'}</p>
          </a>
        );
      })}
    </div>
  </section>

  <!-- Categories Section -->
  <section class="mb-16">
    <div class="mb-8">
      <h2 class="text-3xl font-bold text-granite mb-2">Browse by Category</h2>
      <p class="text-gray-600">Find gyms that match your specific needs</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
      <a
        href="/categories/best-climbing-gyms-for-beginners"
        class="bg-white rounded-lg shadow-md p-6 hover:shadow-xl transition-shadow duration-300 group"
      >
        <h3 class="font-bold text-granite group-hover:text-sage transition-colors mb-2">
          Best for Beginners
        </h3>
        <p class="text-sm text-gray-600">
          Beginner-friendly gyms with intro classes
        </p>
      </a>

      <a
        href="/categories/best-bouldering-climbing-gyms"
        class="bg-white rounded-lg shadow-md p-6 hover:shadow-xl transition-shadow duration-300 group"
      >
        <h3 class="font-bold text-granite group-hover:text-sage transition-colors mb-2">
          Best Bouldering Gyms
        </h3>
        <p class="text-sm text-gray-600">
          Top facilities for bouldering
        </p>
      </a>

      <a
        href="/categories/climbing-gyms-with-sauna"
        class="bg-white rounded-lg shadow-md p-6 hover:shadow-xl transition-shadow duration-300 group"
      >
        <h3 class="font-bold text-granite group-hover:text-sage transition-colors mb-2">
          Gyms with Sauna
        </h3>
        <p class="text-sm text-gray-600">
          Recovery amenities included
        </p>
      </a>

      <a
        href="/categories/affordable-climbing-gyms"
        class="bg-white rounded-lg shadow-md p-6 hover:shadow-xl transition-shadow duration-300 group"
      >
        <h3 class="font-bold text-granite group-hover:text-sage transition-colors mb-2">
          Affordable Gyms
        </h3>
        <p class="text-sm text-gray-600">
          Budget-friendly options
        </p>
      </a>
    </div>
  </section>

  <!-- Getting Started Section -->
  <section class="mb-16 bg-white rounded-lg shadow-md p-8 md:p-12">
    <div class="text-center mb-10">
      <h2 class="text-3xl font-bold text-granite mb-4">New to Indoor Climbing?</h2>
      <p class="text-gray-600 text-lg">We make it easy to start your climbing journey</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
      <div class="text-center">
        <div class="w-16 h-16 bg-sage/20 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl font-bold text-sage">
          1
        </div>
        <h3 class="font-bold text-granite mb-2">Find Your Gym</h3>
        <p class="text-gray-600 text-sm">
          Browse our directory of indoor climbing gyms in your city and nearby areas
        </p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-sage/20 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl font-bold text-sage">
          2
        </div>
        <h3 class="font-bold text-granite mb-2">Check Amenities</h3>
        <p class="text-gray-600 text-sm">
          Filter by bouldering, top rope, lead climbing, or specialized training facilities
        </p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-sage/20 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl font-bold text-sage">
          3
        </div>
        <h3 class="font-bold text-granite mb-2">Read Reviews</h3>
        <p class="text-gray-600 text-sm">
          See ratings and reviews from real climbers to find the best fit for you
        </p>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-sage/20 rounded-full flex items-center justify-center mx-auto mb-4 text-3xl font-bold text-sage">
          4
        </div>
        <h3 class="font-bold text-granite mb-2">Visit & Climb</h3>
        <p class="text-gray-600 text-sm">
          Most gyms offer day passes and intro classes—perfect for first-timers
        </p>
      </div>
    </div>

    <div class="text-center">
      <a
        href="/guides/beginners-guide-to-climbing-gyms"
        class="inline-block bg-sage text-white px-8 py-3 rounded-lg font-bold hover:bg-sage/90 transition-colors"
      >
        Read Our Beginner's Guide
      </a>
    </div>
  </section>

  <!-- Guides Section -->
  <section class="mb-16 bg-gradient-to-br from-sage/10 to-ivory rounded-lg p-8">
    <div class="mb-8">
      <h2 class="text-3xl font-bold text-granite mb-2">Climbing Guides & Resources</h2>
      <p class="text-gray-600">Learn everything you need to know about indoor climbing</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <a
        href="/guides/beginners-guide-to-climbing-gyms"
        class="bg-white rounded-lg shadow-md p-6 hover:shadow-xl transition-shadow group"
      >
        <h3 class="font-bold text-granite group-hover:text-sage transition-colors mb-2">
          Beginner's Guide
        </h3>
        <p class="text-sm text-gray-600">
          Everything you need to know before your first visit
        </p>
      </a>

      <a
        href="/guides/what-to-wear-indoor-rock-climbing"
        class="bg-white rounded-lg shadow-md p-6 hover:shadow-xl transition-shadow group"
      >
        <h3 class="font-bold text-granite group-hover:text-sage transition-colors mb-2">
          What to Wear
        </h3>
        <p class="text-sm text-gray-600">
          Complete guide to climbing clothing and gear
        </p>
      </a>

      <a
        href="/guides/is-climbing-gym-membership-worth-it"
        class="bg-white rounded-lg shadow-md p-6 hover:shadow-xl transition-shadow group"
      >
        <h3 class="font-bold text-granite group-hover:text-sage transition-colors mb-2">
          Membership Guide
        </h3>
        <p class="text-sm text-gray-600">
          Is a climbing gym membership worth it?
        </p>
      </a>
    </div>

    <div class="text-center mt-8">
      <a
        href="/guides"
        class="inline-block text-sage font-medium hover:underline"
      >
        View all guides →
      </a>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="mb-12">
    <h2 class="text-3xl font-bold text-granite mb-6">
      Frequently Asked Questions
    </h2>
    <div class="space-y-6">
      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="font-bold text-granite text-lg mb-3">How much does it cost to climb at an indoor climbing gym?</h3>
        <p class="text-gray-700">
          Day passes typically range from $15-$30, depending on the facility and location. Monthly memberships usually cost
          between $50-$100, with many gyms offering student discounts and family packages. Most gyms also offer punch cards
          and multi-visit packages for better value.
        </p>
      </div>

      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="font-bold text-granite text-lg mb-3">What should I wear to an indoor climbing gym?</h3>
        <p class="text-gray-700">
          Wear comfortable athletic clothing that allows full range of motion—think yoga pants, athletic shorts, or joggers
          with a t-shirt or tank top. Climbing shoes are essential (available to rent at most gyms for $3-$7). Avoid baggy
          clothes that might catch on holds, and remove jewelry before climbing.
        </p>
      </div>

      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="font-bold text-granite text-lg mb-3">Do I need experience to start indoor rock climbing?</h3>
        <p class="text-gray-700">
          No experience needed! Indoor climbing gyms welcome beginners and most offer introductory classes, belay certification
          courses, and routes marked by difficulty level. Staff members are always available to help you get started safely.
          Many gyms require a brief orientation or safety video for first-time visitors.
        </p>
      </div>

      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="font-bold text-granite text-lg mb-3">What's the difference between bouldering and rope climbing?</h3>
        <p class="text-gray-700">
          Bouldering involves climbing shorter walls (10-15 feet) without ropes, with padded mats below for protection.
          Rope climbing uses harnesses and belay systems for climbing taller walls (30-60 feet). Bouldering focuses on
          powerful, technical moves, while rope climbing emphasizes endurance and route-finding over longer distances.
        </p>
      </div>

      <div class="bg-white rounded-lg shadow-md p-6">
        <h3 class="font-bold text-granite text-lg mb-3">Can I go to a climbing gym alone?</h3>
        <p class="text-gray-700">
          Absolutely! Bouldering is perfect for solo climbers since no partner is needed. For rope climbing, many gyms
          offer auto-belay systems that let you climb alone, or have staff-run belay services. Climbing gyms are also
          great places to meet other climbers and make new friends who share your passion.
        </p>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="text-center bg-sage rounded-lg p-12 text-white">
    <h2 class="text-3xl font-bold mb-4">Ready to Find Your Next Climb?</h2>
    <p class="text-lg mb-8 text-white/90">
      Explore hundreds of climbing gyms and start your adventure today
    </p>
    <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
      <a
        href="/search"
        class="inline-block bg-white text-sage px-8 py-4 rounded-lg font-bold text-lg hover:bg-gray-100 transition-colors"
      >
        Advanced Search
      </a>
      <a
        href="/guides"
        class="inline-block bg-transparent border-2 border-white text-white px-8 py-4 rounded-lg font-bold text-lg hover:bg-white/10 transition-colors"
      >
        Read Our Guides
      </a>
    </div>
  </section>
</BaseLayout>
