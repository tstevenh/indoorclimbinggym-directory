---
export const prerender = true;

import BaseLayout from '../../layouts/BaseLayout.astro';
import { generateStudyListSchema, generateBreadcrumbSchema } from '../../utils/schema';

const title = 'Climbing Gym Studies & Research | Indoor Climbing Gym';
const description = 'Data-driven insights and research about indoor climbing gyms, including grading systems, facility standards, and industry trends.';
const pageUrl = 'https://www.indoorclimbinggym.com/studies';

// Auto-discover all studies in this directory
const allStudyFiles = await Astro.glob('./*.astro');

// Filter out index.astro and extract study metadata
const studies = allStudyFiles
  .filter(file => {
    const filename = file.url?.split('/').pop() || '';
    return filename !== '' && !filename.includes('index');
  })
  .map(file => file.studyMetadata)
  .filter(Boolean)
  .sort((a, b) => new Date(b.updatedDate).getTime() - new Date(a.updatedDate).getTime());

// Generate structured data
const studyListSchema = generateStudyListSchema(
  studies,
  'Climbing Gym Research Studies',
  pageUrl
);

// Breadcrumbs
const breadcrumbs = [
  { label: 'Home', url: 'https://www.indoorclimbinggym.com' },
  { label: 'Studies', url: pageUrl },
];

const breadcrumbSchema = generateBreadcrumbSchema(breadcrumbs);

// Combine schemas
const combinedSchema = {
  '@context': 'https://schema.org',
  '@graph': [studyListSchema, breadcrumbSchema]
};

const keywords = [
  'climbing gym research',
  'climbing data',
  'gym grading study',
  'climbing industry analysis',
  'climbing gym trends',
  'indoor climbing statistics'
];
---

<BaseLayout
  title={title}
  description={description}
  canonical={pageUrl}
  keywords={keywords}
  schema={combinedSchema}
  breadcrumbs={breadcrumbs}
>
  <div>
    <!-- Header -->
    <header class="mb-12">
      <h1 class="text-4xl font-bold text-granite mb-4">Climbing Gym Studies & Research</h1>
      <p class="text-xl text-gray-700 leading-relaxed">
        Data-driven insights and comprehensive research about indoor climbing gyms across the United States.
      </p>
    </header>

    <!-- Studies Grid -->
    <div class="grid gap-6 mb-12">
      {studies.map((study) => (
        <a
          href={`/studies/${study.slug}`}
          class="group bg-white rounded-lg shadow-md hover:shadow-xl transition-shadow p-6"
        >
          <div class="flex items-start justify-between">
            <div>
              <h2 class="text-2xl font-bold text-granite mb-2 group-hover:text-sage transition-colors">
                {study.title}
              </h2>
              <p class="text-gray-700 mb-4">
                {study.description}
              </p>
              <div class="flex gap-4 text-sm text-gray-600">
                <span class="flex items-center gap-1">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                  </svg>
                  {study.gymsAnalyzed} Gyms Analyzed
                </span>
                <span class="flex items-center gap-1">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  Updated {new Date(study.updatedDate).getFullYear()}
                </span>
              </div>
            </div>
            <svg class="w-6 h-6 text-sage flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </div>
        </a>
      ))}

      <!-- Placeholder for future studies -->
      <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
        <svg class="w-12 h-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
        <h3 class="text-lg font-semibold text-gray-700 mb-2">More Studies Coming Soon</h3>
        <p class="text-gray-600">
          We're constantly analyzing data to bring you insights about the climbing gym industry.
        </p>
      </div>
    </div>

    <!-- About Our Research -->
    <section class="bg-white rounded-lg shadow-md p-8 mb-12">
      <h2 class="text-2xl font-bold text-granite mb-4">About Our Research</h2>
      <div class="prose max-w-none text-gray-700">
        <p class="mb-4">
          Our research team analyzes data from hundreds of climbing gyms across the United States to provide
          valuable insights for climbers, gym owners, and the climbing community.
        </p>
        <p class="mb-4">
          We focus on:
        </p>
        <ul class="list-disc pl-6 mb-4 space-y-2">
          <li>Grading systems and difficulty standards across different regions</li>
          <li>Facility amenities and their impact on climber satisfaction</li>
          <li>Pricing trends and membership models</li>
          <li>Equipment availability and training facilities</li>
          <li>Geographic distribution and market analysis</li>
        </ul>
        <p>
          All studies are based on real data from our comprehensive database of indoor climbing facilities.
        </p>
      </div>
    </section>

    <!-- CTA -->
    <section class="bg-sage rounded-lg p-12 text-white text-center">
      <h2 class="text-3xl font-bold mb-4">Suggest a Study Topic</h2>
      <p class="text-lg mb-8 text-white/90">
        Have an idea for climbing gym research? We'd love to hear from you!
      </p>
      <a
        href="/contact/"
        class="inline-block px-8 py-3 bg-white text-sage rounded-lg font-medium hover:bg-opacity-90 transition-colors"
      >
        Contact Us
      </a>
    </section>
  </div>
</BaseLayout>
